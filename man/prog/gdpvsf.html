<!doctype html><head><title>GEMPAK Help: gdpvsf</title></head><body>
<a href=../../help_and_documentation>GEMPAK Manual</a> | 
<a href=../prog/>Programs</a><br><hr>
<pre>
GDPVSF vertically interpolates grid data to an arbitrary surface.

INPUT PARAMETERS 

    <a href=../parm/gdfile.html>GDFILE</a>    Input grid file  
    <a href=../parm/gdoutf.html>GDOUTF</a>    Output grid file    
    <a href=../parm/gfunc.html>GFUNC</a>     Grid function           
    <a href=../parm/gdattim.html>GDATTIM</a>   Grid date/time                   
    <a href=../parm/gvcord.html>GVCORD</a>    Grid vertical coordinate                
    <a href=../parm/startl.html>STARTL</a>    Level to start search        
    <a href=../parm/stopl.html>STOPL</a>     Level to stop search          
    <a href=../parm/desire.html>DESIRE</a>    Desired interpolation surface        
    <a href=../parm/gdoutl.html>GDOUTL</a>    Output grid level (m)   
    <a href=../parm/gvoutc.html>GVOUTC</a>    Output vertical coordinate
    <a href=../parm/gpack.html>GPACK</a>     Number of bits/packing type
    GLIST     List of grids to interpolate    
    <a href=../parm/pmax.html>PMAX</a>      Maximum pressure to search

PROGRAM DESCRIPTION 

    GDPVSF interpolates grid data vertically to an arbitrary 
    functional surface.  In the following discussion, it will
    be assumed that the functional surface is a surface of 
    constant potential vorticity.

    <a href=../parm/gdfile.html>GDFILE</a> is the input grid to use for interpolation, and it 
    must contain the necessary grids at the specified times and
    levels.  For example, for <a href=../parm/gfunc.html>GFUNC</a> = MUL(AVOR(WND),STAP), <a href=../parm/gdfile.html>GDFILE</a>
    must contain the grids UREL (UWND), VREL (VWND) and STAP at
    the vertical coordinate given by <a href=../parm/gvcord.html>GVCORD</a>.

    <a href=../parm/gdoutf.html>GDOUTF</a> must be an already-existing grid file.  GDPVSF will 
    not create a new grid file if <a href=../parm/gdoutf.html>GDOUTF</a> does not exist.  You 
    can use GDDIAG to create the necessary grids for GDPVSF.

    The grid function (potential vorticity) is specified in 
    <a href=../parm/gfunc.html>GFUNC</a>.  <a href=../parm/desire.html>DESIRE</a> specifies the value of the potential 
    vorticity surface to which the grids should be interpolated.
    The vertical coordinate of the input grids is given by 
    <a href=../parm/gvcord.html>GVCORD</a>.  The output vertical coordinate and grid level are
    specified separately and arbitrarily by the user through
    <a href=../parm/gvoutc.html>GVOUTC</a> and <a href=../parm/gdoutl.html>GDOUTL</a>, respectively.  <a href=../parm/gvoutc.html>GVOUTC</a> must be defined 
    either as PVBL (ascending) or PVAB (descending).

    GDPVSF will not produce an interpolated grid of the input
    vertical coordinate unless it is also specified in GLIST.
    For example, if <a href=../parm/gvcord.html>GVCORD</a> is THTA but GLIST contains only UWND,
    VWND and PRES, no output grid for the parameter THTA will
    be written.  It is good practice to always include <a href=../parm/gvcord.html>GVCORD</a>
    in GLIST. Grid functions can not be interpolated.

    The program begins the search for the desired pv surface
    at <a href=../parm/startl.html>STARTL</a>.  If the surface is not encountered by the time
    <a href=../parm/stopl.html>STOPL</a> is reached, the values at the grid point are set to
    missing.  The first time <a href=../parm/gfunc.html>GFUNC</a>=<a href=../parm/desire.html>DESIRE</a> is encountered, with 
    <a href=../parm/gfunc.html>GFUNC</a> increasing upward, the interpolation is performed and 
    the search is started at the next grid point.  To prevent 
    searching the lower troposphere while in THTA coordinates, 
    <a href=../parm/pmax.html>PMAX</a> may be set to a non-zero value.

    Switching <a href=../parm/startl.html>STARTL</a> and <a href=../parm/stopl.html>STOPL</a> causes the search to be made in 
    the opposite direction.  Locations where the output is 
    different for a different search direction imply that 
    the surface is present at more than one level, i.e. that 
    the tropopause is folded.

EXAMPLES 

    1.  Use an input grid file in THTA coordinates which 
        contains PRES, UWND, VWND, STAP!10, and RELH between 260 K
        and 350 K, interpolate THTA, UWND, VWND, and PRES to the 
        1.5 PVU surface. Assign the output grids to the nominal 
        15 m grid level in the preexisting file PV.GRD.  Look for 
        the lowest occurrence of the 1.5 PVU surface, assuming that it 
        occurs above 700 mb.  Call the output vertical coordinate pvbl,
        which represents the pv surface found from below.
                                                                                
        <a href=../parm/gdfile.html>GDFILE</a>   =  input.grd                            
        <a href=../parm/gdoutf.html>GDOUTF</a>   =  pv.grd                         
        <a href=../parm/gfunc.html>GFUNC</a>    =  mul(avor(obs),stap)     
        <a href=../parm/gdattim.html>GDATTIM</a>  =  last             
        <a href=../parm/gvcord.html>GVCORD</a>   =  thta
        <a href=../parm/startl.html>STARTL</a>   =  260 
        <a href=../parm/stopl.html>STOPL</a>    =  350 
        <a href=../parm/desire.html>DESIRE</a>   =  0.00000015
        <a href=../parm/gdoutl.html>GDOUTL</a>   =  15 
        <a href=../parm/gvoutc.html>GVOUTC</a>   =  pvbl
        <a href=../parm/gpack.html>GPACK</a>    =      
        GLIST    =  thta;uwnd;vwnd;pres    
        <a href=../parm/pmax.html>PMAX</a>     =  700

    2.  Repeat the search in the opposite direction.  Change
        the vertical coordinate to distinguish between this
        set of grids and the previous set of grids.

        <a href=../parm/gdfile.html>GDFILE</a>   =  input.grd                          
        <a href=../parm/gdoutf.html>GDOUTF</a>   =  pv.grd                       
        <a href=../parm/gfunc.html>GFUNC</a>    =  mul(avor(obs),stap)   
        <a href=../parm/gdattim.html>GDATTIM</a>  =  last                                       
        <a href=../parm/gvcord.html>GVCORD</a>   =  thta                             
        <a href=../parm/startl.html>STARTL</a>   =  350 
        <a href=../parm/stopl.html>STOPL</a>    =  260    
        <a href=../parm/desire.html>DESIRE</a>   =  0.00000015   
        <a href=../parm/gdoutl.html>GDOUTL</a>   =  15    
        <a href=../parm/gvoutc.html>GVOUTC</a>   =  pvab
        <a href=../parm/gpack.html>GPACK</a>    =      
        GLIST    =  thta;uwnd;vwnd;pres    
        <a href=../parm/pmax.html>PMAX</a>     =  700

ERROR MESSAGES 
</pre>
<script src="/gempak/add_in.js" type="text/javascript"></script>
</body>
</html>
